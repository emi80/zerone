#include <stdio.h>
#include "predict.c"

void
test_predict
(void)
{

   double case1[18] = {
      0.0338405224702613, 0.538855412185446, 0.549795644770003,
      0.00090957975214423, 0.0254611434606641, 0.198055686594919,
      0.574890452024094, 0.636915160052977, 0.698939868081859,
      0.23827697734949, 0.336179136756629, 0.434081296163767,
      0.414473708009163, 0.517765209866611, 0.62105671172406,
      0.0718397730127468, 0.00333073543379349, 0.0375029981291674
   };

   test_assert(fabs(predict(zscale(case1)) - 0.551572) < 1e-3);

   double case2[18] = {
      0.00169173070088186, 0.999377116926393, 0.00046543319629242,
      0.146414277999692, 0.000395937847310032, 0.973176719107977,
      0.849259219058708, 0.849259219058708, 0.849259219058708,
      0.627772533717025, 0.627772533717025, 0.627772533717025,
      0.739200140108962, 0.739200140108962, 0.739200140108962,
      0.511615494636454, 0.413931373715291, 1.23601301878537
   };

   test_assert(fabs(predict(zscale(case2)) + 1.133339) < 1e-3);

   double case3[18] = {
      0.000571301109269696, 0.999376116529347, 2.38438981215253e-23,
      0.00279957257737685, 2.59237483501309e-22, 0.995986611469501,
      0.963488813574714, 1.28810436864871, 1.61271992372271,
      0.727969062452416, 0.941106936955331, 1.15424481145825,
      0.451392118212325, 0.824688385325185, 1.19798465243804,
      0.350580129865963, 0.266862710646682, 0.891202047498119
   };

   test_assert(fabs(predict(zscale(case3)) + 1.8283239) < 1e-3);

}
